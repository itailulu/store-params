!function(e,o){"function"==typeof define&&define.amd?define([],o):"object"==typeof module&&module.exports?module.exports=o():e.StoreParams=o()}(this,(function(){var e=function(o){"use strict";var t=Object.create(e.prototype);t.options={cookieDuration:14,cookieDomain:!1,storeUTMs:!0,storeReferrer:!0,include:[],exclude:[],keyName:"QPAR",callback:function(){}},o&&Object.keys(o).forEach((function(e){t.options[e]=o[e]}));var n=document.referrer?new URL(document.referrer):null,r=new URL(document.location.href),a=new URLSearchParams(r.search);if(t.options.cookieDomain||(t.options.cookieDomain="."+r.hostname.replace(/^(www\.)/,"")),t.options.storeUTMs){var i=[{param:"utm_medium"},{param:"utm_campaign"},{param:"utm_term"},{param:"utm_content"}];t.options.include=t.options.include.concat(i)}var s=window.localStorage,c=function(e,o){let n=JSON.parse(s.getItem(t.options.keyName));"object"==typeof n&&null!=n||(n={}),n[e]=o,s.setItem(t.options.keyName,JSON.stringify(n))},u=function(e){s.removeItem(t.options.keyName)};return t.read=function(e){return function(e){let o=JSON.parse(s.getItem(t.options.keyName));return void 0!==e?o[e]:o}(e)},function(){if(t.options.storeUTMs){if(i.filter((function(e){return a.has(e.param)})).length||n&&n.hostname!==r.hostname){u();for(var e=0;e<i.length;e++)u(i[e].param)}if(!t.options.exclude.includes("utm_source")){var o=null;a.has("utm_source")?o=a.get("utm_source"):n&&n.hostname!==r.hostname&&(o=n.hostname.replace(/^(www\.)/,"")),null!==o&&c("utm_source",o)}}for(e=0;e<t.options.include.length;e++)!0!==a.has(t.options.include[e].param)||t.options.exclude.includes(t.options.include[e].param)||(t.options.include[e].storage?c(t.options.include[e].storage,a.get(t.options.include[e].param)):c(t.options.include[e].param,a.get(t.options.include[e].param)));t.options.storeReferrer&&n&&n.hostname!==r.hostname&&c("referrer",n.href)}(),t};return e}));
